<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/suggestions-jquery@21.12.0/dist/css/suggestions.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/suggestions-jquery@21.12.0/dist/js/jquery.suggestions.min.js"></script>
<script>
function join(arr /*, separator */) {
    var separator = arguments.length > 1 ? arguments[1] : ", ";
    return arr.filter(function (n) { return n }).join(separator);
  }

  function geoQuality(qc_geo) {
    var localization = {
      "0": "точные",
      "1": "ближайший дом",
      "2": "улица",
      "3": "населенный пункт",
      "4": "город"
    };
    return localization[qc_geo] || qc_geo;
  }

  function fillPostalCode(address) {
    var postKode = address.postal_code;
    if (address.postal_code) $("#PostIndex").val(postKode);
    else $("#PostIndex").val(0);
  }

  function fillCountry(address) {
    var cntry = address.country;
    $("#Country").val(cntry);
  }

  function fillRegionFull(address) {
    $("#RegionFull").val(join([
      join([address.region, address.region_type], ". "),
      join([address.area, address.area_type], " ")
    ]));
  }

  function fillRegion(address) {
    $("#Region").val(address.region);
  }

  function fillCity(address) {
    $("#Town").val(join([
      join([address.city, address.city_type], ". "),
      join([address.settlement_type, address.settlement], " ")
    ]));
  }

  function fillStreet(address) {
    $("#Street").val(
      join([address.street, address.street_type], ". ")
    );
  }

  function fillHouse(address) {
    $("#House").val(join([
      join([address.house_type, address.house], ". "),
      join([address.block_type, address.block], " ")
    ]));
  }

  function fillFlat(address) {
    $("#Flat").val(
      join([address.flat_type, address.flat], " ")
    );
  }

  function fillGeo(address) {
    if (address.qc_geo !== "5") {
      $("#Lat").val(address.geo_lat);
      $("#Lon").val(address.geo_lon);
      $("#Gc").val(geoQuality(address.qc_geo));
    }
    else {
      $("#Lat").val(0);
      $("#Lon").val(0);
    }
  }

  function fillSelected(suggestion) {
    var address = suggestion.data;
    fillPostalCode(address);
    fillCountry(address);
    fillRegion(address);
    fillRegionFull(address);
    fillCity(address);
    fillStreet(address);
    fillHouse(address);
    fillFlat(address);
    fillGeo(address);
  }

  $("#AdrName").suggestions({
    token: "6aaaba01d2581d13f80a158aa03154cc7d0e470d",
    type: "ADDRESS",
    onSelect: fillSelected
  });

</script>